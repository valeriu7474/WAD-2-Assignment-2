{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\vblas\\\\Desktop\\\\COLLEGE\\\\Year 3\\\\Web App 2\\\\wad2-Assignment2\\\\moviesApp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\vblas\\\\Desktop\\\\COLLEGE\\\\Year 3\\\\Web App 2\\\\wad2-Assignment2\\\\moviesApp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\vblas\\\\Desktop\\\\COLLEGE\\\\Year 3\\\\Web App 2\\\\wad2-Assignment2\\\\moviesApp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\vblas\\\\Desktop\\\\COLLEGE\\\\Year 3\\\\Web App 2\\\\wad2-Assignment2\\\\moviesApp\\\\src\\\\contexts\\\\authContext.js\";\nimport React, { useState, createContext } from \"react\";\nimport { login } from \"../api/movie-api\";\nexport var AuthContext = createContext(null);\n\nvar AuthContextProvider = props => {\n  var existingToken = localStorage.getItem(\"token\");\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAuthenticated = _useState2[0],\n      setIsAuthenticated = _useState2[1];\n\n  var _useState3 = useState(existingToken),\n      _useState4 = _slicedToArray(_useState3, 2),\n      authToken = _useState4[0],\n      setAuthToken = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      userName = _useState6[0],\n      setUserName = _useState6[1]; //Function to put JWT token in local storage.\n\n\n  var setToken = data => {\n    localStorage.setItem(\"token\", data);\n    setAuthToken(data);\n  };\n\n  var authenticate = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(username, password) {\n      var result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return login(username, password);\n\n            case 2:\n              result = _context.sent;\n\n              if (result.token) {\n                setToken(result.token);\n                setIsAuthenticated(true);\n                setUserName(username);\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function authenticate(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }(); //   const register = async (username, password) => {\n  //     const result = await signup(username, password);\n  //     console.log(result.code);\n  //     return (result.code === 201) ? true : false;\n  //   };\n\n\n  var signout = () => {\n    setTimeout(() => setIsAuthenticated(false), 100);\n  }; //get favourites for the logged in user\n\n\n  var getUserFavourites = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(username) {\n      var movies;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return getFavourites(username);\n\n            case 2:\n              movies = _context2.sent;\n              return _context2.abrupt(\"return\", movies);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function getUserFavourites(_x3) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var getUserWatchLater = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(username) {\n      var movies;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return getWatchList(username);\n\n            case 2:\n              movies = _context3.sent;\n              return _context3.abrupt(\"return\", movies);\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function getUserWatchLater(_x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: {\n      isAuthenticated,\n      authenticate,\n      register,\n      signout,\n      userName,\n      getUserFavourites,\n      getUserWatchLater\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 5\n    }\n  }, props.children);\n};\n\nexport default AuthContextProvider;","map":{"version":3,"sources":["C:/Users/vblas/Desktop/COLLEGE/Year 3/Web App 2/wad2-Assignment2/moviesApp/src/contexts/authContext.js"],"names":["React","useState","createContext","login","AuthContext","AuthContextProvider","props","existingToken","localStorage","getItem","isAuthenticated","setIsAuthenticated","authToken","setAuthToken","userName","setUserName","setToken","data","setItem","authenticate","username","password","result","token","signout","setTimeout","getUserFavourites","getFavourites","movies","getUserWatchLater","getWatchList","register","children"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,aAA1B,QAA+C,OAA/C;AACA,SAASC,KAAT,QAAsB,kBAAtB;AAEA,OAAO,IAAMC,WAAW,GAAGF,aAAa,CAAC,IAAD,CAAjC;;AAEP,IAAMG,mBAAmB,GAAIC,KAAD,IAAW;AACrC,MAAMC,aAAa,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAtB;;AADqC,kBAESR,QAAQ,CAAC,KAAD,CAFjB;AAAA;AAAA,MAE9BS,eAF8B;AAAA,MAEbC,kBAFa;;AAAA,mBAGHV,QAAQ,CAACM,aAAD,CAHL;AAAA;AAAA,MAG9BK,SAH8B;AAAA,MAGnBC,YAHmB;;AAAA,mBAILZ,QAAQ,CAAC,EAAD,CAJH;AAAA;AAAA,MAI9Ba,QAJ8B;AAAA,MAIpBC,WAJoB,kBAMrC;;;AACA,MAAMC,QAAQ,GAAIC,IAAD,IAAU;AACzBT,IAAAA,YAAY,CAACU,OAAb,CAAqB,OAArB,EAA8BD,IAA9B;AACAJ,IAAAA,YAAY,CAACI,IAAD,CAAZ;AACD,GAHD;;AAKA,MAAME,YAAY;AAAA,wEAAG,iBAAOC,QAAP,EAAiBC,QAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACElB,KAAK,CAACiB,QAAD,EAAWC,QAAX,CADP;;AAAA;AACbC,cAAAA,MADa;;AAEnB,kBAAIA,MAAM,CAACC,KAAX,EAAkB;AAChBP,gBAAAA,QAAQ,CAACM,MAAM,CAACC,KAAR,CAAR;AACAZ,gBAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAI,gBAAAA,WAAW,CAACK,QAAD,CAAX;AACD;;AANkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAZD,YAAY;AAAA;AAAA;AAAA,KAAlB,CAZqC,CAqBvC;AACA;AACA;AACA;AACA;;;AAEE,MAAMK,OAAO,GAAG,MAAM;AACpBC,IAAAA,UAAU,CAAC,MAAMd,kBAAkB,CAAC,KAAD,CAAzB,EAAkC,GAAlC,CAAV;AACD,GAFD,CA3BqC,CA+BrC;;;AACA,MAAMe,iBAAiB;AAAA,yEAAG,kBAAON,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACHO,aAAa,CAACP,QAAD,CADV;;AAAA;AAClBQ,cAAAA,MADkB;AAAA,gDAEhBA,MAFgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAjBF,iBAAiB;AAAA;AAAA;AAAA,KAAvB;;AAKA,MAAMG,iBAAiB;AAAA,yEAAG,kBAAOT,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACHU,YAAY,CAACV,QAAD,CADT;;AAAA;AAClBQ,cAAAA,MADkB;AAAA,gDAEhBA,MAFgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAjBC,iBAAiB;AAAA;AAAA;AAAA,KAAvB;;AAKA,sBACE,oBAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AACLnB,MAAAA,eADK;AAELS,MAAAA,YAFK;AAGLY,MAAAA,QAHK;AAILP,MAAAA,OAJK;AAKLV,MAAAA,QALK;AAMLY,MAAAA,iBANK;AAOLG,MAAAA;AAPK,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAWGvB,KAAK,CAAC0B,QAXT,CADF;AAeD,CAzDD;;AA2DA,eAAe3B,mBAAf","sourcesContent":["import React, { useState, createContext } from \"react\";\r\nimport { login } from \"../api/movie-api\";\r\n\r\nexport const AuthContext = createContext(null);\r\n\r\nconst AuthContextProvider = (props) => {\r\n  const existingToken = localStorage.getItem(\"token\");\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [authToken, setAuthToken] = useState(existingToken);\r\n  const [userName, setUserName] = useState(\"\");\r\n\r\n  //Function to put JWT token in local storage.\r\n  const setToken = (data) => {\r\n    localStorage.setItem(\"token\", data);\r\n    setAuthToken(data);\r\n  }\r\n\r\n  const authenticate = async (username, password) => {\r\n    const result = await login(username, password);\r\n    if (result.token) {\r\n      setToken(result.token)\r\n      setIsAuthenticated(true);\r\n      setUserName(username);\r\n    }\r\n  };\r\n\r\n//   const register = async (username, password) => {\r\n//     const result = await signup(username, password);\r\n//     console.log(result.code);\r\n//     return (result.code === 201) ? true : false;\r\n//   };\r\n\r\n  const signout = () => {\r\n    setTimeout(() => setIsAuthenticated(false), 100);\r\n  };\r\n\r\n  //get favourites for the logged in user\r\n  const getUserFavourites = async (username) => {\r\n    const movies = await getFavourites(username);\r\n    return (movies);\r\n  };\r\n\r\n  const getUserWatchLater = async (username) => {\r\n    const movies = await getWatchList(username);\r\n    return (movies);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        isAuthenticated,\r\n        authenticate,\r\n        register,\r\n        signout,\r\n        userName,\r\n        getUserFavourites,\r\n        getUserWatchLater,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport default AuthContextProvider;"]},"metadata":{},"sourceType":"module"}